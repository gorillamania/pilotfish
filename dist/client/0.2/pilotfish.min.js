/* Pilotfish, a toolkit for improving user experience, v0.2.0 http://pilotfish.io
Copyright (c) 2012 Nick Sullivan, MIT license https://github.com/pilotfish/pilotfish/blob/master/LICENSE */
(function(e,t,n,r){function p(){return e.JSON?e.jQuery?!0:!1:!1}function x(e){return jQuery.isPlainObject(e)}if(e.Pilotfish&&e.Pilotfish.version)return;var i={},s=[],o={},u={},a={},f=p(),l=n.protocol==="https:",c=l?"//pilotfish.github.com/":"http://cdn.pilotfish.io/",h=e.Pilotfish&&e.Pilotfish.q||[],d=function(){if(!arguments.length)return!0;if(!f)return!0;var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return typeof d[e]=="function"?d[e].apply(d,t):typeof i[e]=="function"?i[e].apply(d,t):typeof u[e]=="function"?u[e].apply(d,t):!1};e.Pilotfish=d,d.version="0.2.0",d.core=function(e,t){i[e]=t};var v=i.subscribe=function(){var e=jQuery(d);return e.on.apply(e,arguments),!0},m=i.unsubscribe=function(){var e=jQuery(d);e.off.apply(e,arguments)},g=i.publish=function(){var e=jQuery(d);return y({name:arguments[0],args:arguments}),e.trigger.apply(e,arguments),!0},y=i.eventLog=function(e){return e&&s.push(e),s},b=i.onload=function(t){jQuery(e).load(t)},w=i.onready=function(e){jQuery(t).ready(e)},E=i.extend=function(e,t){return jQuery.extend(e,t)},S=i.error=function(e,t){g("error",{type:t,error:e}),t&&g("error:"+t,{error:e})},T=i.loadScript=function(e,n){g("external_script:started",{src:e});var r="script",i=t.getElementsByTagName(r)[0],s=t.createElement(r);s.async=!0,s.src=e,s.onload=function(){s.onloadDone||(s.onloadDone=!0,g("external_script:loaded",{src:e}),typeof n=="function"&&n())},s.onreadystatechange=function(){/loaded|complete/.test(s.readyState)&&!s.onloadDone&&(s.onloadDone=!0,g("external_script:loaded",{src:e}),typeof n=="function"&&n())},i.parentNode.insertBefore(s,i)},N=i.registerPlugin=function(e,t){u[e]=t},C=i.requirePlugin=function(e,t){if(k(e))return;t=t||[c,"client/plugins/",e,"/pilotfish-",e,".min.js"].join(""),T(t,function(){g("plugin:loaded",{plugin:e})})},k=i.hasPlugin=function(e){return typeof u[e]=="function"},L=i.log=function(t){g("log",{msg:t}),e.console&&e.console.log.apply(e.console,arguments)},A=i.pageData=function(e,t){return t!==r&&(o[e]=_(t)),o[e]||""},O=i.setting=function(e,t){return t!==r&&(a[e]=_(t)),a[e]||""},M=i.S=function(e){return jQuery(e)},_=i.toS=function(e){return e===r||e===null||typeof e=="number"&&isNaN(e)?"":typeof e=="object"?JSON.stringify(e):""+e};(function(){for(var i=0,s=h.length;i<s;i++)d.apply(d,h[i]);h=[],e.jQuery&&(jQuery(e).load(function(){g("window:load")}).bind("hashchange",function(){g("window:hashchange",{path:n.hash.substring(1)})}),jQuery(t).ready(function(){g("document:ready")}))})()})(window,document,location);